[
  {
    "attributes": {
      "disabled": false,
      "name": "csrf_token",
      "required": true,
      "type": "hidden",
      "value": "Yms2cmo1NTA2OWFub3F3dHI2NHcxNnd2MTNsNzhocTk="
    },
    "group": "default",
    "messages": [],
    "meta": {},
    "type": "input"
  },
  {
    "attributes": {
      "disabled": false,
      "name": "webauthn_login_trigger",
      "onclick": "if (!window.PublicKeyCredential) {\n  alert('This browser does not support WebAuthn!');\n} else {\n  function bufferDecode(value) {\n    return Uint8Array.from(atob(value), c =\u003e c.charCodeAt(0));\n  }\n\n  function bufferEncode(value) {\n    return btoa(String.fromCharCode.apply(null, new Uint8Array(value)))\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=/g, '');\n  }\n\n  const opt = {\"publicKey\":{\"challenge\":\"EjcLNulRLiiAvumMXEwUWT+CDYtnsRpznIBlC2/Ljwo=\",\"timeout\":60000,\"rpId\":\"localhost\",\"allowCredentials\":[{\"type\":\"public-key\",\"id\":\"Zm9vZm9v\"},{\"type\":\"public-key\",\"id\":\"YmFyYmFy\"}],\"userVerification\":\"discouraged\"}}\n  opt.publicKey.challenge = bufferDecode(opt.publicKey.challenge);\n  opt.publicKey.allowCredentials = opt.publicKey.allowCredentials.map(function (value) {\n    return {\n      ...value,\n      id: bufferDecode(value.id)\n    }\n  });\n\n  navigator.credentials.get(opt).then(function (credential) {\n    document.querySelector('*[name=\"webauthn_login\"]').value  = JSON.stringify({\n      id: credential.id,\n      rawId: bufferEncode(credential.rawId),\n      type: credential.type,\n      response: {\n        authenticatorData: bufferEncode(credential.response.authenticatorData),\n        clientDataJSON: bufferEncode(credential.response.clientDataJSON),\n        signature: bufferEncode(credential.response.signature),\n        userHandle: bufferEncode(credential.response.userHandle),\n      },\n    })\n\n    document.querySelector('*[name=\"webauthn_login_trigger\"]').closest('form').submit()\n  }).catch((err) =\u003e {\n    alert(err)\n  })\n}\n",
      "type": "button",
      "value": ""
    },
    "group": "webauthn",
    "messages": [],
    "meta": {
      "label": {
        "id": 1010008,
        "text": "Use security key",
        "type": "info"
      }
    },
    "type": "input"
  },
  {
    "attributes": {
      "disabled": false,
      "name": "webauthn_login",
      "type": "hidden",
      "value": ""
    },
    "group": "webauthn",
    "messages": [],
    "meta": {},
    "type": "input"
  }
]
